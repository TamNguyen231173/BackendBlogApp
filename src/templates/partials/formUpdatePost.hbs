<div class="row">
  <div class="col-lg-12">

    <div class="col-lg-12">
      <div class="d-flex mb-3 justify-content-end">
        <button class="btn btn-success nav-link right-bar-toggle">Publish now
          <i class="mdi mdi-arrow-right ml-1"></i>
        </button>
      </div>
    </div>

    <form>
      {{! ===== Image ===== }}
      <div class="col-lg-12">
        <div class="card ribbon-box">
          <div class="card-body">
            <div class="ribbon ribbon-secondary float-left">
              <i class="mdi mdi-access-point mr-1"></i>
              Image
            </div>
            <h5 class="text-secondary float-right mt-0">The best image on the
              world</h5>
            <div class="ribbon-content">
              <div class="form-group mb-0">

                <input
                  id="image-input-link"
                  type="text"
                  id="title-input"
                  class="form-control"
                  style="
                      border: none; 
                      border-bottom: 1px solid #e3e6f0; 
                      border-radius: 0; 
                      box-shadow: none; 
                      font-size: 1.1rem; 
                      font-weight: 500; 
                      letter-spacing: 0.5px; 
                      line-height: 1.5; 
                      padding: 0.5rem 0;
                  "
                  value="{{post.image}}"
                  placeholder="Enter link image"
                />

              </div>
              <div
                class="dropzone d-block mt-2"
                id="myAwesomeDropzone"
                data-plugin="dropzone"
                data-previews-container="#file-previews"
                data-upload-preview-template="#uploadPreviewTemplate"
              >
                <div class="dz-message needsclick">
                  <i class="h1 text-muted dripicons-cloud-upload"></i>
                  <h3>Drop files here or click to upload.</h3>
                  <span class="text-muted font-13">(This is just a demo
                    dropzone. Selected files are
                    <strong>not</strong>
                    actually uploaded.)</span>
                </div>
              </div>
            </div>
          </div>
          <!-- end card-body -->
        </div>
        <!-- end card-->
      </div>

      {{! ===== Title ===== }}
      <div class="col-lg-12">
        <div class="card ribbon-box">
          <div class="card-body">
            <div class="ribbon ribbon-primary float-left"><i
                class="mdi mdi-access-point mr-1"
              ></i>
              Title</div>
            <h5 class="text-primary float-right mt-0">Write your best title here</h5>
            <div class="ribbon-content">
              {{! Title input }}
              <div class="form-group mb-0">
                <input
                  type="text"
                  id="title-input"
                  class="form-control"
                  style="
                  border: none; 
                  border-bottom: 1px solid #e3e6f0; 
                  border-radius: 0; 
                  box-shadow: none; 
                  font-size: 1.5rem; 
                  font-weight: 700; 
                  letter-spacing: 1px; 
                  line-height: 1.5; 
                  padding: 0.5rem 0; 
                  text-transform: uppercase;"
                  placeholder="Enter title"
                  value="{{post.title}}"
                />
              </div>
            </div>
          </div>
        </div>
      </div>

      {{! ===== Content ===== }}
      <div class="col-lg-12">
        <div class="card ribbon-box">
          <div class="card-body">
            <div class="ribbon ribbon-info float-right"><i
                class="mdi mdi-access-point mr-1"
              ></i>
              Content</div>
            <h5 class="text-info float-left mt-0">Write your greatest content
              here</h5>
            <div class="ribbon-content">
              {{! Title input }}
              <div id="summernote-basic">{{post.content}}</div>
            </div>
        </div>     
      </div>
    </form>

    {{!-- Right bar --}}
<div class="right-bar">
    <div class="rightbar-title">
        <a href="javascript:void(0);" class="right-bar-toggle float-right">
            <i class="dripicons-cross noti-icon"></i>
        </a>
        <h5 class="m-0">Settings</h5>
    </div>

    <div class="rightbar-content h-100" data-simplebar="init"><div class="simplebar-wrapper" style="margin: 0px;"><div class="simplebar-height-auto-observer-wrapper"><div class="simplebar-height-auto-observer"></div></div><div class="simplebar-mask"><div class="simplebar-offset" style="right: 0px; bottom: 0px;"><div class="simplebar-content-wrapper" style="height: 100%; overflow: hidden;"><div class="simplebar-content" style="padding: 0px;">

        <div class="p-3">
            <div class="alert alert-warning" role="alert">
                <strong>Steve Jobs </strong> Everybody should learn to program a computer because it teaches you how to think.
            </div>

            <!-- Category -->
            <h5 class="mt-3">Category</h5>
            <hr class="mt-1">
            <div class="form-group mb-3">
                <select class="form-control" id="category-select">
                    <option value="Actions">Actions</option>
                    <option value="Healthy">Healthy</option>
                    <option value="Hot trends">Hot trends</option>
                </select>
            </div>
      
            <!-- Author -->
            <h5 class="mt-4">Author</h5>
            <hr class="mt-1">
            <div class="form-group mb-3">
               <input type="text" id="author-input" class="form-control" value="{{post.author}}">
            </div>

            <button class="submit-update-post btn btn-primary btn-block mt-4" id="resetBtn">
              <i class="mdi mdi-clipboard-text-multiple-outline mr-1"></i>
              Save And Publish
              </button>
        </div> <!-- end padding-->

    </div></div></div></div><div class="simplebar-placeholder" style="width: auto; height: 497px;"></div></div><div class="simplebar-track simplebar-horizontal" style="visibility: hidden;"><div class="simplebar-scrollbar" style="width: 0px; display: none;"></div></div><div class="simplebar-track simplebar-vertical" style="visibility: hidden;"><div class="simplebar-scrollbar" style="height: 0px; display: none;"></div></div></div>
  </div>
  </div>
</div>
</div>

<script>
  $(document).ready(function() { 

    $('.dropzone').html('<img src="' +
      $('#image-input-link').val() + '" alt="image" class="img-fluid " />'); 
     
    $('#image-input-link').on('input',function(e){
      $('.dropzone').html('<img src="' +
      e.target.value + '" alt="image" class="img-fluid " />'); 
    }) 

    $('.submit-update-post').click(function(e) {
      e.preventDefault();
      let title = $('#title-input').val();
      let content = $('#summernote-basic').summernote('code');
      let image = $('#image-input-link').val();
      let author = $('#author-input').val();
      let category = $('#category-select').val();
      const data = {
        title,
        content,
        image,
        author,
        category
      }

      $.ajax("/api/posts/{{post._id}}", {
        'type': 'PATCH',
        'data': JSON.stringify(data),
        'contentType': 'application/json',
        error: function(err) {
          console.log(err);
        },
        success: function(data) {
          window.location.href = '/api/posts/getAllPosts';
        }
      })
    });
  })
</script>